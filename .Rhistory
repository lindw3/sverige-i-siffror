colnames(df) <- c("Land" , "Kod" , "År" , "Social protection" ,
"Health" , "General public services" ,
"Education" , "Economic affairs" ,
"Defense" , "Order and safety" ,
"Housing and community amenities",
"Recreation, culture and religion" ,
"Environmental protection")
df <- df %>%
filter(
År == 2023
) %>%
pivot_longer(!c(1:3) , names_to = "Kategori" ,
values_to = "Andel")
p <- df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = fct_reorder(Kategori, Andel, .desc = TRUE), y = Andel ,
text = paste("Kategori:" , Kategori ,
"\nAndel av statliga utgifter, %:" , round(Andel, 2)))) +
geom_col(fill = "#5991E5") +
sis_theme +
theme(axis.text.x = element_text(angle = 70, hjust = 1 , vjust = 1)) +
xlab(NULL) + ylab("Andel av statliga utgifter, %")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/statligautgifter_fördelning_sverige.html")
# OECD-länder
p <- df %>%
filter(Land == "OECD countries") %>%
ggplot(aes(x = fct_reorder(Kategori, Andel, .desc = TRUE), y = Andel ,
text = paste("Kategori:" , Kategori ,
"\nAndel av statliga utgifter, %:" , round(Andel, 2)))) +
geom_col(fill = "#5991E5") +
sis_theme +
theme(axis.text.x = element_text(angle = 70, hjust = 1 , vjust = 1)) +
xlab(NULL) + ylab("Andel av statliga utgifter, %")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/statligautgifter_fördelning.html")
# Skatter som andel av statens inkomster (kolla bara Sverige)
df <- read.csv("https://ourworldindata.org/grapher/tax-revenue-national-income-longrun.csv?v=1&csvType=full&useColumnShortNames=true")
colnames(df) <- c("Land" , "Kod", "År" , "Andel")
p <- df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Andel  , group = 2,
text = paste("År:" , År ,
"\nAndel av GDP, %:" , round(Andel, 2)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(1880, max(df$År))) +
scale_y_continuous(limits = c(0 , 55) ,
breaks =  seq(0, 50, 10)) +
xlab(NULL) + ylab("Andel av GDP, %")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/skatter_statligainkomster_sverige.html")
# Skatteintäkter som andel av GDP (jämfört med andra länder)
df <- read.csv("https://ourworldindata.org/grapher/tax-revenues-as-a-share-of-gdp-unu-wider.csv?v=1&csvType=full&useColumnShortNames=true")
colnames(df) <- c("Land" , "Kod", "År" , "Andel")
p <- df %>%
ggplot(aes(x = År, y = Andel, group = Land,
alpha = Land == "Sweden" ,
linewidth = Land == "Sweden" ,
colour = Land == "Sweden",
text = paste("År:" , År ,
"\nLand:" , Land,
"\nAndel av GDP, %:" , round(Andel, 2)))) +
geom_line() +
scale_colour_manual(values = c("TRUE" = "#D7E559", "FALSE" = "#5991E5")) +
scale_alpha_manual(values = c("TRUE" = 1, "FALSE" = 0.25)) +
scale_linewidth_manual(values = c("TRUE" = 1.35, "FALSE" = 0.5)) +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), max(df$År))) +
scale_y_continuous(limits = c(0 , max(df$Andel + 5)) ,
breaks =  seq(0, 60, 10)) +
guides(alpha = "none", linewidth = "none" ,colour = "none") +
xlab(NULL) +
ylab("Andel av GDP, %")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/skatter_statligainkomster.html")
df <- read.csv("https://ourworldindata.org/grapher/gender-wage-gap-oecd.csv?v=1&csvType=full&useColumnShortNames=true")
library(jsonlite)
library(ggplot2)
library(stringr)
library(scales)
library(dplyr)
library(tidyr)
library(DT)
library(png)
library(data.table)
library(magrittr)
library(gridExtra)
library(openxlsx)
library(patchwork)
library(ggthemes)
library(plotly)
library(htmlwidgets)
library(reticulate)
library(ggridges)
library(forecast)
library(GGally)
library(cluster)
library(sf)
library(readxl)
library(forcats)
df <- read.csv("https://ourworldindata.org/grapher/gender-wage-gap-oecd.csv?v=1&csvType=full&useColumnShortNames=true")
colnames(df) <- c("Land" , "Kod", "År" , "Andel")
lönegap_kön <- read_excel("data/lönegap_kön.xlsx")
union(df, lönegap_kön)
df <- union(df, lönegap_kön)
df <- read.csv("https://ourworldindata.org/grapher/gender-wage-gap-oecd.csv?v=1&csvType=full&useColumnShortNames=true")
colnames(df) <- c("Land" , "Kod", "År" , "Andel")
lönegap_kön <- read_excel("data/lönegap_kön.xlsx") # Komplettering med data från SCB efter 2013
df <- union(df, lönegap_kön)
View(df)
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Andel  , group = 2,
text = paste("År:" , År ,
"\nAndel av männens inkomst, %:" , round(Andel, 2)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(1975, max(df$År))) +
scale_y_continuous(limits = c(0 , 100) ,
breaks =  seq(0, 100, 25)) +
xlab(NULL) + ylab("Kvinnors andel av männens inkomst, %")
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Andel  , group = 2,
text = paste("År:" , År ,
"\nLönegap, %:" , round(Andel, 2)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(1975, max(df$År))) +
scale_y_continuous(limits = c(0 , 100) ,
breaks =  seq(0, 100, 25)) +
xlab(NULL) + ylab("Skillnad i genomsnittslön, %")
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Andel  , group = 2,
text = paste("År:" , År ,
"\nLönegap, %:" , round(Andel, 2)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(1975, max(df$År))) +
scale_y_continuous(limits = c(0 , 50) ,
breaks =  seq(0, 50, 10)) +
xlab(NULL) + ylab("Skillnad i genomsnittslön, %")
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Andel  , group = 2,
text = paste("År:" , År ,
"\nLönegap, %:" , round(Andel, 2)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(1975, max(df$År))) +
scale_y_continuous(limits = c(0 , 30) ,
breaks =  seq(0, 30, 10)) +
xlab(NULL) + ylab("Skillnad i genomsnittslön, %")
df %>%
ggplot(aes(x = År, y = Andel, group = Land,
alpha = Land == "Sweden" ,
linewidth = Land == "Sweden" ,
colour = Land == "Sweden",
text = paste("År:" , År ,
"\nLand:" , Land,
"\nLönegap, %:" , round(Andel, 2)))) +
geom_line() +
scale_colour_manual(values = c("TRUE" = "#D7E559", "FALSE" = "#5991E5")) +
scale_alpha_manual(values = c("TRUE" = 1, "FALSE" = 0.25)) +
scale_linewidth_manual(values = c("TRUE" = 1.35, "FALSE" = 0.5)) +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), 2016)) +
scale_y_continuous(limits = c(0 , max(df$Andel + 5)) ,
breaks =  seq(0, 60, 10)) +
guides(alpha = "none", linewidth = "none" ,colour = "none") +
xlab(NULL) +
ylab("Skillnad i genomsnittslön, %")
df %>%
filter(År == 1970:2016) %>%
ggplot(aes(x = År, y = Andel, group = Land,
alpha = Land == "Sweden" ,
linewidth = Land == "Sweden" ,
colour = Land == "Sweden",
text = paste("År:" , År ,
"\nLand:" , Land,
"\nLönegap, %:" , round(Andel, 2)))) +
geom_line() +
scale_colour_manual(values = c("TRUE" = "#D7E559", "FALSE" = "#5991E5")) +
scale_alpha_manual(values = c("TRUE" = 1, "FALSE" = 0.25)) +
scale_linewidth_manual(values = c("TRUE" = 1.35, "FALSE" = 0.5)) +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), 2016)) +
scale_y_continuous(limits = c(0 , max(df$Andel + 5)) ,
breaks =  seq(0, 60, 10)) +
guides(alpha = "none", linewidth = "none" ,colour = "none") +
xlab(NULL) +
ylab("Skillnad i genomsnittslön, %")
df %>%
filter(År %in% c(1970:2016)) %>%
ggplot(aes(x = År, y = Andel, group = Land,
alpha = Land == "Sweden" ,
linewidth = Land == "Sweden" ,
colour = Land == "Sweden",
text = paste("År:" , År ,
"\nLand:" , Land,
"\nLönegap, %:" , round(Andel, 2)))) +
geom_line() +
scale_colour_manual(values = c("TRUE" = "#D7E559", "FALSE" = "#5991E5")) +
scale_alpha_manual(values = c("TRUE" = 1, "FALSE" = 0.25)) +
scale_linewidth_manual(values = c("TRUE" = 1.35, "FALSE" = 0.5)) +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), 2016)) +
scale_y_continuous(limits = c(0 , max(df$Andel + 5)) ,
breaks =  seq(0, 60, 10)) +
guides(alpha = "none", linewidth = "none" ,colour = "none") +
xlab(NULL) +
ylab("Skillnad i genomsnittslön, %")
df <- read.csv("https://ourworldindata.org/grapher/proportion-of-women-in-senior-and-middle-management-positions.csv?v=1&csvType=full&useColumnShortNames=true")
colnames(df) <- c("Land" , "Kod", "År" , "Andel")
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Andel  , group = 2,
text = paste("År:" , År ,
"\nAndel kvinnor, %:" , round(Andel, 2)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(1975, max(df$År))) +
scale_y_continuous(limits = c(0 , 50) ,
breaks =  seq(0, 50, 10)) +
xlab(NULL) + ylab("Andel kvinnor i chefsposition, %")
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Andel  , group = 2,
text = paste("År:" , År ,
"\nAndel kvinnor, %:" , round(Andel, 2)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(2000, 2022)) +
scale_y_continuous(limits = c(0 , 50) ,
breaks =  seq(0, 50, 10)) +
xlab(NULL) + ylab("Andel kvinnor i chefsposition, %")
df %>%
ggplot(aes(x = År, y = Andel, group = Land,
alpha = Land == "Sweden" ,
linewidth = Land == "Sweden" ,
colour = Land == "Sweden",
text = paste("År:" , År ,
"\nLand:" , Land,
"\nAndel kvinnor, %:" , round(Andel, 2)))) +
geom_line() +
scale_colour_manual(values = c("TRUE" = "#D7E559", "FALSE" = "#5991E5")) +
scale_alpha_manual(values = c("TRUE" = 1, "FALSE" = 0.25)) +
scale_linewidth_manual(values = c("TRUE" = 1.35, "FALSE" = 0.5)) +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), max(df$År))) +
scale_y_continuous(limits = c(0 , max(df$Andel + 5)) ,
breaks =  seq(0, 60, 10)) +
guides(alpha = "none", linewidth = "none" ,colour = "none") +
xlab(NULL) +
ylab("Andel kvinnor i chefsposition, %")
df <- read.csv("https://ourworldindata.org/grapher/gender-wage-gap-oecd.csv?v=1&csvType=full&useColumnShortNames=true")
colnames(df) <- c("Land" , "Kod", "År" , "Andel")
lönegap_kön <- read_excel("data/lönegap_kön.xlsx")
df <- union(df, lönegap_kön) # Komplettering med data från SCB efter 2013
p <- df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Andel  , group = 2,
text = paste("År:" , År ,
"\nLönegap, %:" , round(Andel, 2)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(1975, max(df$År))) +
scale_y_continuous(limits = c(0 , 30) ,
breaks =  seq(0, 30, 10)) +
xlab(NULL) + ylab("Skillnad i genomsnittslön, %")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/lönegap_sverige.html")
# ... jämfört med andra länder
p <- df %>%
filter(År %in% c(1970:2016)) %>%
ggplot(aes(x = År, y = Andel, group = Land,
alpha = Land == "Sweden" ,
linewidth = Land == "Sweden" ,
colour = Land == "Sweden",
text = paste("År:" , År ,
"\nLand:" , Land,
"\nLönegap, %:" , round(Andel, 2)))) +
geom_line() +
scale_colour_manual(values = c("TRUE" = "#D7E559", "FALSE" = "#5991E5")) +
scale_alpha_manual(values = c("TRUE" = 1, "FALSE" = 0.25)) +
scale_linewidth_manual(values = c("TRUE" = 1.35, "FALSE" = 0.5)) +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), 2016)) +
scale_y_continuous(limits = c(0 , max(df$Andel + 5)) ,
breaks =  seq(0, 60, 10)) +
guides(alpha = "none", linewidth = "none" ,colour = "none") +
xlab(NULL) +
ylab("Skillnad i genomsnittslön, %")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/lönegap.html")
# Andel kvinnor i chefspositioner
df <- read.csv("https://ourworldindata.org/grapher/proportion-of-women-in-senior-and-middle-management-positions.csv?v=1&csvType=full&useColumnShortNames=true")
colnames(df) <- c("Land" , "Kod", "År" , "Andel")
p <- df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Andel  , group = 2,
text = paste("År:" , År ,
"\nAndel kvinnor, %:" , round(Andel, 2)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(2000, 2022)) +
scale_y_continuous(limits = c(0 , 50) ,
breaks =  seq(0, 50, 10)) +
xlab(NULL) + ylab("Andel kvinnor i chefsposition, %")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/kvinnligachefer_sverige.html")
# ... jämfört med andra länder
p <- df %>%
ggplot(aes(x = År, y = Andel, group = Land,
alpha = Land == "Sweden" ,
linewidth = Land == "Sweden" ,
colour = Land == "Sweden",
text = paste("År:" , År ,
"\nLand:" , Land,
"\nAndel kvinnor, %:" , round(Andel, 2)))) +
geom_line() +
scale_colour_manual(values = c("TRUE" = "#D7E559", "FALSE" = "#5991E5")) +
scale_alpha_manual(values = c("TRUE" = 1, "FALSE" = 0.25)) +
scale_linewidth_manual(values = c("TRUE" = 1.35, "FALSE" = 0.5)) +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), max(df$År))) +
scale_y_continuous(limits = c(0 , max(df$Andel + 5)) ,
breaks =  seq(0, 60, 10)) +
guides(alpha = "none", linewidth = "none" ,colour = "none") +
xlab(NULL) +
ylab("Andel kvinnor i chefsposition, %")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/kvinnligachefer.html")
df <- read.csv("https://ourworldindata.org/grapher/annual-working-hours-per-worker.csv?v=1&csvType=full&useColumnShortNames=true")
df <- read.csv("https://ourworldindata.org/grapher/annual-working-hours-per-person-employed.csv?v=1&csvType=full&useColumnShortNames=true")
df <- read.csv("https://ourworldindata.org/grapher/annual-working-hours-per-person-employed.csv?v=1&csvType=full&useColumnShortNames=true")
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Antal  , group = 2,
text = paste("År:" , År ,
"\nArbetstimmar/år:" , round(Antal)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(min(df$Year), 2016)) +
scale_y_continuous(limits = c(0 , 17500) ,
breaks =  seq(0, 17500, 2500)) +
xlab(NULL) + ylab("Genomsnittligt antal arbetstimmar/anställd/år")
colnames(df) <- c("Land" , "Kod", "År" , "Antal")
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Antal  , group = 2,
text = paste("År:" , År ,
"\nArbetstimmar/år:" , round(Antal)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(min(df$Year), 2016)) +
scale_y_continuous(limits = c(0 , 17500) ,
breaks =  seq(0, 17500, 2500)) +
xlab(NULL) + ylab("Genomsnittligt antal arbetstimmar/anställd/år")
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Antal  , group = 2,
text = paste("År:" , År ,
"\nArbetstimmar/år:" , round(Antal)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), 2016)) +
scale_y_continuous(limits = c(0 , 17500) ,
breaks =  seq(0, 17500, 2500)) +
xlab(NULL) + ylab("Genomsnittligt antal arbetstimmar/anställd/år")
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Antal  , group = 2,
text = paste("År:" , År ,
"\nArbetstimmar/år:" , round(Antal)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), 2016)) +
scale_y_continuous(limits = c(0 , 1750) ,
breaks =  seq(0, 1750, 250)) +
xlab(NULL) + ylab("Genomsnittligt antal arbetstimmar/anställd/år")
df <- read.csv("https://ourworldindata.org/grapher/annual-working-hours-per-worker.csv?v=1&csvType=full&useColumnShortNames=true")
View(df)
colnames(df) <- c("Land" , "Kod", "År" , "Antal")
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Antal  , group = 2,
text = paste("År:" , År ,
"\nArbetstimmar/år:" , round(Antal)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), 2016)) +
scale_y_continuous(limits = c(0 , 1750) ,
breaks =  seq(0, 1750, 250)) +
xlab(NULL) + ylab("Genomsnittligt antal arbetstimmar/anställd/år")
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Antal  , group = 2,
text = paste("År:" , År ,
"\nArbetstimmar/år:" , round(Antal)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), 2017)) +
scale_y_continuous(limits = c(0 , 1750) ,
breaks =  seq(0, 1750, 250)) +
xlab(NULL) + ylab("Genomsnittligt antal arbetstimmar/anställd/år")
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Antal  , group = 2,
text = paste("År:" , År ,
"\nArbetstimmar/år:" , round(Antal)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(1870, 2017)) +
scale_y_continuous(limits = c(0 , 3500) ,
breaks =  seq(0, 3500, 500)) +
xlab(NULL) + ylab("Genomsnittligt antal arbetstimmar/anställd/år")
p <- df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Antal  , group = 2,
text = paste("År:" , År ,
"\nArbetstimmar/år:" , round(Antal)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(1870, 2017)) +
scale_y_continuous(limits = c(0 , 3500) ,
breaks =  seq(0, 3500, 500)) +
xlab(NULL) + ylab("Genomsnittligt antal arbetstimmar/anställd/år")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
ig
img
df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Antal  , group = 2,
text = paste("År:" , År ,
"\nArbetstimmar/år:" , round(Antal)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(1870, 1980, 2017)) +
scale_y_continuous(limits = c(0 , 3500) ,
breaks =  seq(0, 3500, 500)) +
xlab(NULL) + ylab("Genomsnittligt antal arbetstimmar/anställd/år")
df %>%
ggplot(aes(x = År, y = Antal, group = Land,
alpha = Land == "Sweden" ,
linewidth = Land == "Sweden" ,
colour = Land == "Sweden",
text = paste("År:" , År ,
"\nLand:" , Land,
"\nArbetstimmar/år:" , round(Antal, 2)))) +
geom_line() +
scale_colour_manual(values = c("TRUE" = "#D7E559", "FALSE" = "#5991E5")) +
scale_alpha_manual(values = c("TRUE" = 1, "FALSE" = 0.25)) +
scale_linewidth_manual(values = c("TRUE" = 1.35, "FALSE" = 0.5)) +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), max(df$År))) +
scale_y_continuous(limits = c(0 , max(df$Antal + 100)) ,
breaks =  seq(0, 3500, 500)) +
guides(alpha = "none", linewidth = "none" ,colour = "none") +
xlab(NULL) +
ylab("Genomsnittligt antal arbetstimmar/anställd/år")
df <- read.csv("https://ourworldindata.org/grapher/annual-working-hours-per-worker.csv?v=1&csvType=full&useColumnShortNames=true")
colnames(df) <- c("Land" , "Kod", "År" , "Antal")
p <- df %>%
filter(Land == "Sweden") %>%
ggplot(aes(x = År, y = Antal  , group = 2,
text = paste("År:" , År ,
"\nArbetstimmar/år:" , round(Antal)))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(1870, 1980, 2017)) +
scale_y_continuous(limits = c(0 , 3500) ,
breaks =  seq(0, 3500, 500)) +
xlab(NULL) + ylab("Genomsnittligt antal arbetstimmar/anställd/år")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/arbetstimmar_sverige.html")
# ... jämfört med andra länder
# "Sverige är även ett av de länder med flest antal lediga dagar från arbete i form av semester och röda dagar"
p <- df %>%
ggplot(aes(x = År, y = Antal, group = Land,
alpha = Land == "Sweden" ,
linewidth = Land == "Sweden" ,
colour = Land == "Sweden",
text = paste("År:" , År ,
"\nLand:" , Land,
"\nArbetstimmar/år:" , round(Antal, 2)))) +
geom_line() +
scale_colour_manual(values = c("TRUE" = "#D7E559", "FALSE" = "#5991E5")) +
scale_alpha_manual(values = c("TRUE" = 1, "FALSE" = 0.25)) +
scale_linewidth_manual(values = c("TRUE" = 1.35, "FALSE" = 0.5)) +
sis_theme +
scale_x_continuous(breaks = c(min(df$År), max(df$År))) +
scale_y_continuous(limits = c(0 , max(df$Antal + 100)) ,
breaks =  seq(0, 3500, 500)) +
guides(alpha = "none", linewidth = "none" ,colour = "none") +
xlab(NULL) +
ylab("Genomsnittligt antal arbetstimmar/anställd/år")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/arbetstimmar.html")
