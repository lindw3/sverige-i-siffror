mutate(Andel = `Antal anställda` / sum(`Antal anställda`)) %>%
ggplot(aes(x = Sektor , y = `Antal anställda` , fill = Kön,
text = paste(Kön, "\nSektor:" , Sektor , "\nAntal: ", comma(`Antal anställda`),
"\nAndel: ", round(Andel, 2) * 100 , "%"))) +
geom_col(position = "dodge") +
sis_theme +
xlab(NULL) +
theme(axis.text.x = element_text(angle = 70, hjust = 1 , vjust = 1)) +
scale_fill_manual(values = c("Kvinnor" = "#E56759",
"Män" = "#5991E5")) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 6), labels = scales::comma)
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/anställning_sektor_kön.html")
# Genomsnittslön utifrån sektor och kön
p <- lön_utbildningsnivå %>%
filter(Sektor != "Samtliga" , Kön != "Totalt" , Utbildning == "Alla") %>%
ggplot(aes(x = Sektor , y = Lön, fill = Kön,
text = paste(Kön, "\nSektor: ", Sektor , "\nGenomsnittslön: ", comma(Lön)))) +
geom_col(position = "dodge") +
sis_theme +
theme(axis.text.x = element_text(angle = 70, hjust = 1 , vjust = 1)) +
ylab("Genomsnittslön") + xlab(NULL) +
scale_fill_manual(values = c("Kvinnor" = "#E56759",
"Män" = "#5991E5")) +
scale_y_continuous(labels = comma)
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = FALSE)
saveWidget(img, "images/lön_sektor_kön.html")
# Genomsnittslöner utifrån utbildningsnivå och kön
levels = c("Förgymnasial -9 år" , "Förgymnasial 9+ år" , "Gymnasial -3 år", "Gymnasial 3 år",
"Eftergymnasial -3 år", "Eftergymnasial 3+ år", "Forskarutbildning")
p <- lön_utbildningsnivå %>%
filter(Sektor == "Samtliga" , Kön != "Totalt" , Utbildning != "Alla") %>%
ggplot(aes(x = factor(Utbildning, levels = levels) , y = Lön, fill = Kön,
text = paste(Kön, "\nUtbildningsnivå: ", Utbildning , "\nGenomsnittslön: ", comma(Lön)))) +
geom_col(position = "dodge") +
sis_theme +
ylab("Genomsnittslön") +
xlab(NULL) +
theme(axis.text.x = element_text(angle = 70, hjust = 1 , vjust = 1)) +
scale_fill_manual(values = c("Kvinnor" = "#E56759",
"Män" = "#5991E5")) +
scale_y_continuous(labels = comma)
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = FALSE)
saveWidget(img, "images/lön_utbildning_kön.html")
# Barnafödande i Sverige
df <- read.csv("https://ourworldindata.org/grapher/children-born-per-woman.csv?v=1&csvType=full&useColumnShortNames=true")
df <- df %>%
mutate(fertility_rate_hist = round(fertility_rate_hist, 2))
p <- df %>%
filter(Entity == "Sweden") %>%
ggplot(aes(x = Year, y = fertility_rate_hist  , group = 2,
text = paste("År:" , Year ,
"\nBarn:" , fertility_rate_hist))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
theme(axis.text.x = element_text(angle = 70, hjust = 1 , vjust = 1)) +
scale_x_continuous(breaks = c(1891, 1935, 2023)) +
scale_y_continuous(limits = c(0 , 4.2) ,
breaks = 0:4) +
xlab(NULL) + ylab("Barn per kvinna")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/barnafödande_sverige.html")
df <- read.csv("https://ourworldindata.org/grapher/children-born-per-woman.csv?v=1&csvType=full&useColumnShortNames=true")
df <- df %>%
mutate(fertility_rate_hist = round(fertility_rate_hist, 2))
p <- df %>%
filter(Entity == "Sweden") %>%
ggplot(aes(x = Year, y = fertility_rate_hist  , group = 2,
text = paste("År:" , Year ,
"\nBarn:" , fertility_rate_hist))) +
geom_line(linewidth = 1 , colour = "#5991E5") +
sis_theme +
scale_x_continuous(breaks = c(1891, 1935, 2023)) +
scale_y_continuous(limits = c(0 , 4.2) ,
breaks = 0:4) +
xlab(NULL) + ylab("Barn per kvinna")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/barnafödande_sverige.html")
levels = c("81-100 %" , "61-80 %" ,  "41-60 %" , "21-40 %" , "0-20 %")
df <- partisympati_kön_inkomst %>%
filter(År == 2024 ,
Kön == "Båda") %>%
pivot_longer(!c(År, Kön, Inkomst) , names_to = "Parti" , values_to = "Andel")
p <- df %>%
ggplot(aes(y = Parti, x = Andel, fill = factor(Inkomst , level = levels),
text = paste(Parti, "\nInkomst: ", Inkomst, "\nAndel: ", Andel, "%"))) +
geom_col(position = "dodge") +
xlab("Andel, %") + ylab(NULL) +
labs(fill = "Inkomstpercentil") +
sis_theme +
scale_fill_manual(values = c("0-20 %" = "#5991E5",
"21-40 %" = "#D7E559" ,
"41-60 %" = "#E56759",
"61-80 %" = "#AD59E5" ,
"81-100 %" = "#59E5AD"))
p
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/partisympatier_inkomst.html")
df <- read.csv("https://ourworldindata.org/grapher/children-born-per-woman.csv?v=1&csvType=full&useColumnShortNames=true")
View(df)
unique(df$Entity)
df %>%
filter(Entity == "Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries") %>%
mutate(
Entity = case_when(
Entity == "Sweden" ~ "Sverige" ,
Entity == "High-income countries" ~ "Höginkomstländer" ,
Entity == "Low-income countries" ~ "Låginkomstländer" ,
Entity == "Lower-middle-income countries" ~ "Undre medelinkomstländer" ,
Entity == "Upper-middle-income countries" ~ "Övre medelinkomstländer" ,
TRUE ~ Entity
)
)
df %>%
filter(Entity == "Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries")
df %>%
filter(Entity == "Sweden",
`High-income countries`,
`Low-income countries`,
`Lower-middle-income countries`,
`Upper-middle-income countries`)
df %>%
filter(Entity %in% c("Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries")) %>%
mutate(
Entity = case_when(
Entity == "Sweden" ~ "Sverige",
Entity == "High-income countries" ~ "Höginkomstländer",
Entity == "Low-income countries" ~ "Låginkomstländer",
Entity == "Lower-middle-income countries" ~ "Undre medelinkomstländer",
Entity == "Upper-middle-income countries" ~ "Övre medelinkomstländer",
TRUE ~ Entity
)
)
df %>%
filter(Entity %in% c("Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries")) %>%
mutate(
Entity = case_when(
Entity == "Sweden" ~ "Sverige",
Entity == "High-income countries" ~ "Höginkomstländer",
Entity == "Low-income countries" ~ "Låginkomstländer",
Entity == "Lower-middle-income countries" ~ "Undre medelinkomstländer",
Entity == "Upper-middle-income countries" ~ "Övre medelinkomstländer",
TRUE ~ Entity
)
) %>%
ggplot(aes(x = Year, y = fertility_rate_hist  ,
group = Entity, colour = Entity,
text = paste("År:" , Year ,
"\nLand/region:" , Entity,
"\nBarn:" , fertility_rate_hist))) +
geom_line(linewidth = 1) +
scale_colour_manual(values = c(
"Sverige" = "#5991E5",
"Låginkomstländer" = "#D7E559",
"Undre medelinkomstländer" = "#E56759",
"Övre medelinkomstländer" = "#AD59E5",
"Höginkomstländer" = "#59E5AD"
))
sis_theme +
scale_x_continuous(breaks = c(1891, 1935, 2023)) +
scale_y_continuous(limits = c(0 , 4.2) ,
breaks = 0:4) +
xlab(NULL) + ylab("Barn per kvinna")
df %>%
filter(Entity %in% c("Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries")) %>%
mutate(
Entity = case_when(
Entity == "Sweden" ~ "Sverige",
Entity == "High-income countries" ~ "Höginkomstländer",
Entity == "Low-income countries" ~ "Låginkomstländer",
Entity == "Lower-middle-income countries" ~ "Undre medelinkomstländer",
Entity == "Upper-middle-income countries" ~ "Övre medelinkomstländer",
TRUE ~ Entity
)
) %>%
ggplot(aes(x = Year, y = fertility_rate_hist  ,
group = Entity, colour = Entity,
text = paste("År:" , Year ,
"\nLand/region:" , Entity,
"\nBarn:" , fertility_rate_hist))) +
geom_line(linewidth = 1) +
scale_colour_manual(values = c(
"Sverige" = "#5991E5",
"Låginkomstländer" = "#D7E559",
"Undre medelinkomstländer" = "#E56759",
"Övre medelinkomstländer" = "#AD59E5",
"Höginkomstländer" = "#59E5AD"
)) +
sis_theme +
scale_x_continuous(breaks = c(1891, 1935, 2023)) +
scale_y_continuous(limits = c(0 , 4.2) ,
breaks = 0:4) +
xlab(NULL) + ylab("Barn per kvinna")
df %>%
filter(Entity %in% c("Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries")) %>%
mutate(
Entity = case_when(
Entity == "Sweden" ~ "Sverige",
Entity == "High-income countries" ~ "Höginkomstländer",
Entity == "Low-income countries" ~ "Låginkomstländer",
Entity == "Lower-middle-income countries" ~ "Undre medelinkomstländer",
Entity == "Upper-middle-income countries" ~ "Övre medelinkomstländer",
TRUE ~ Entity
)
) %>%
ggplot(aes(x = Year, y = fertility_rate_hist  ,
group = Entity, colour = Entity,
text = paste("År:" , Year ,
"\nLand/region:" , Entity,
"\nBarn:" , fertility_rate_hist))) +
geom_line(linewidth = 1) +
scale_colour_manual(values = c(
"Sverige" = "#5991E5",
"Låginkomstländer" = "#D7E559",
"Undre medelinkomstländer" = "#E56759",
"Övre medelinkomstländer" = "#AD59E5",
"Höginkomstländer" = "#59E5AD"
)) +
sis_theme +
scale_x_continuous(breaks = c(1891, 1935, max(Year))) +
scale_y_continuous(limits = c(0 , 9) ,
breaks = 0:9) +
xlab(NULL) + ylab("Barn per kvinna")
df %>%
filter(Entity %in% c("Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries")) %>%
mutate(
Entity = case_when(
Entity == "Sweden" ~ "Sverige",
Entity == "High-income countries" ~ "Höginkomstländer",
Entity == "Low-income countries" ~ "Låginkomstländer",
Entity == "Lower-middle-income countries" ~ "Undre medelinkomstländer",
Entity == "Upper-middle-income countries" ~ "Övre medelinkomstländer",
TRUE ~ Entity
)
) %>%
ggplot(aes(x = Year, y = fertility_rate_hist  ,
group = Entity, colour = Entity,
text = paste("År:" , Year ,
"\nLand/region:" , Entity,
"\nBarn:" , fertility_rate_hist))) +
geom_line(linewidth = 1) +
scale_colour_manual(values = c(
"Sverige" = "#5991E5",
"Låginkomstländer" = "#D7E559",
"Undre medelinkomstländer" = "#E56759",
"Övre medelinkomstländer" = "#AD59E5",
"Höginkomstländer" = "#59E5AD"
)) +
sis_theme +
scale_x_continuous(breaks = c(1891, 1935, max(df$Year))) +
scale_y_continuous(limits = c(0 , 9) ,
breaks = 0:9) +
xlab(NULL) + ylab("Barn per kvinna")
p <- df %>%
filter(Entity %in% c("Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries")) %>%
mutate(
Entity = case_when(
Entity == "Sweden" ~ "Sverige",
Entity == "High-income countries" ~ "Höginkomstländer",
Entity == "Low-income countries" ~ "Låginkomstländer",
Entity == "Lower-middle-income countries" ~ "Undre medelinkomstländer",
Entity == "Upper-middle-income countries" ~ "Övre medelinkomstländer",
TRUE ~ Entity
)
) %>%
ggplot(aes(x = Year, y = fertility_rate_hist  ,
group = Entity, colour = Entity,
text = paste("År:" , Year ,
"\nLand/region:" , Entity,
"\nBarn:" , fertility_rate_hist))) +
geom_line(linewidth = 1) +
scale_colour_manual(values = c(
"Sverige" = "#5991E5",
"Låginkomstländer" = "#D7E559",
"Undre medelinkomstländer" = "#E56759",
"Övre medelinkomstländer" = "#AD59E5",
"Höginkomstländer" = "#59E5AD"
)) +
sis_theme +
scale_x_continuous(breaks = c(1891, 1935, max(df$Year))) +
scale_y_continuous(limits = c(0 , 7) ,
breaks = 0:7) +
xlab(NULL) + ylab("Barn per kvinna")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/barnafödande.html")
p <- df %>%
filter(Entity %in% c("Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries")) %>%
mutate(
Entity = case_when(
Entity == "Sweden" ~ "Sverige",
Entity == "High-income countries" ~ "Höginkomstländer",
Entity == "Low-income countries" ~ "Låginkomstländer",
Entity == "Lower-middle-income countries" ~ "Undre medelinkomstländer",
Entity == "Upper-middle-income countries" ~ "Övre medelinkomstländer",
TRUE ~ Entity
)
) %>%
ggplot(aes(x = Year, y = fertility_rate_hist  ,
group = Entity, colour = Entity,
text = paste("År:" , Year ,
"\nLand/region:" , Entity,
"\nBarn:" , fertility_rate_hist))) +
geom_line(linewidth = 1) +
scale_colour_manual(values = c(
"Sverige" = "#5991E5",
"Låginkomstländer" = "#D7E559",
"Undre medelinkomstländer" = "#E56759",
"Övre medelinkomstländer" = "#AD59E5",
"Höginkomstländer" = "#59E5AD"
)) +
sis_theme +
scale_x_continuous(breaks = c(1891, max(df$Year))) +
scale_y_continuous(limits = c(0 , 7) ,
breaks = 0:7) +
xlab(NULL) + ylab("Barn per kvinna")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/barnafödande.html")
df <- read.csv("https://ourworldindata.org/grapher/children-born-per-woman.csv?v=1&csvType=full&useColumnShortNames=true")
df <- df %>%
mutate(fertility_rate_hist = round(fertility_rate_hist, 2))
p <- df %>%
filter(Entity %in% c("Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries")) %>%
mutate(
Entity = case_when(
Entity == "Sweden" ~ "Sverige",
Entity == "High-income countries" ~ "Höginkomstländer",
Entity == "Low-income countries" ~ "Låginkomstländer",
Entity == "Lower-middle-income countries" ~ "Undre medelinkomstländer",
Entity == "Upper-middle-income countries" ~ "Övre medelinkomstländer",
TRUE ~ Entity
)
) %>%
ggplot(aes(x = Year, y = fertility_rate_hist  ,
group = Entity, colour = Entity,
text = paste("År:" , Year ,
"\nLand/region:" , Entity,
"\nBarn:" , fertility_rate_hist))) +
geom_line(linewidth = 1) +
scale_colour_manual(values = c(
"Sverige" = "#5991E5",
"Låginkomstländer" = "#D7E559",
"Undre medelinkomstländer" = "#E56759",
"Övre medelinkomstländer" = "#AD59E5",
"Höginkomstländer" = "#59E5AD"
)) +
sis_theme +
scale_x_continuous(breaks = c(1891, max(df$Year))) +
scale_y_continuous(limits = c(0 , 7) ,
breaks = 0:7) +
labs(legend = "Land/region") +
xlab(NULL) + ylab("Barn per kvinna")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
img
?labs
p
df %>%
filter(Entity %in% c("Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries")) %>%
mutate(
Entity = case_when(
Entity == "Sweden" ~ "Sverige",
Entity == "High-income countries" ~ "Höginkomstländer",
Entity == "Low-income countries" ~ "Låginkomstländer",
Entity == "Lower-middle-income countries" ~ "Undre medelinkomstländer",
Entity == "Upper-middle-income countries" ~ "Övre medelinkomstländer",
TRUE ~ Entity
)
) %>%
ggplot(aes(x = Year, y = fertility_rate_hist  ,
group = Entity, colour = Entity,
text = paste("År:" , Year ,
"\nLand/region:" , Entity,
"\nBarn:" , fertility_rate_hist))) +
geom_line(linewidth = 1) +
scale_colour_manual(values = c(
"Sverige" = "#5991E5",
"Låginkomstländer" = "#D7E559",
"Undre medelinkomstländer" = "#E56759",
"Övre medelinkomstländer" = "#AD59E5",
"Höginkomstländer" = "#59E5AD"
)) +
sis_theme +
scale_x_continuous(breaks = c(1891, max(df$Year))) +
scale_y_continuous(limits = c(0 , 7) ,
breaks = 0:7) +
legend("Land/region") +
xlab(NULL) + ylab("Barn per kvinna")
df %>%
filter(Entity %in% c("Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries")) %>%
mutate(
Entity = case_when(
Entity == "Sweden" ~ "Sverige",
Entity == "High-income countries" ~ "Höginkomstländer",
Entity == "Low-income countries" ~ "Låginkomstländer",
Entity == "Lower-middle-income countries" ~ "Undre medelinkomstländer",
Entity == "Upper-middle-income countries" ~ "Övre medelinkomstländer",
TRUE ~ Entity
)
) %>%
ggplot(aes(x = Year, y = fertility_rate_hist  ,
group = Entity, colour = Entity,
text = paste("År:" , Year ,
"\nLand/region:" , Entity,
"\nBarn:" , fertility_rate_hist))) +
geom_line(linewidth = 1) +
scale_colour_manual(name = "Land/region" ,
values = c(
"Sverige" = "#5991E5",
"Låginkomstländer" = "#D7E559",
"Undre medelinkomstländer" = "#E56759",
"Övre medelinkomstländer" = "#AD59E5",
"Höginkomstländer" = "#59E5AD"
)) +
sis_theme +
scale_x_continuous(breaks = c(1891, max(df$Year))) +
scale_y_continuous(limits = c(0 , 7) ,
breaks = 0:7) +
xlab(NULL) + ylab("Barn per kvinna")
p <- df %>%
filter(Entity %in% c("Sweden",
"High-income countries",
"Low-income countries",
"Lower-middle-income countries",
"Upper-middle-income countries")) %>%
mutate(
Entity = case_when(
Entity == "Sweden" ~ "Sverige",
Entity == "High-income countries" ~ "Höginkomstländer",
Entity == "Low-income countries" ~ "Låginkomstländer",
Entity == "Lower-middle-income countries" ~ "Undre medelinkomstländer",
Entity == "Upper-middle-income countries" ~ "Övre medelinkomstländer",
TRUE ~ Entity
)
) %>%
ggplot(aes(x = Year, y = fertility_rate_hist  ,
group = Entity, colour = Entity,
text = paste("År:" , Year ,
"\nLand/region:" , Entity,
"\nBarn:" , fertility_rate_hist))) +
geom_line(linewidth = 1) +
scale_colour_manual(name = "Land/region" ,
values = c(
"Sverige" = "#5991E5",
"Låginkomstländer" = "#D7E559",
"Undre medelinkomstländer" = "#E56759",
"Övre medelinkomstländer" = "#AD59E5",
"Höginkomstländer" = "#59E5AD"
)) +
sis_theme +
scale_x_continuous(breaks = c(1891, max(df$Year))) +
scale_y_continuous(limits = c(0 , 7) ,
breaks = 0:7) +
xlab(NULL) + ylab("Barn per kvinna")
img <- ggplotly(p, tooltip = "text") %>%
config(displayModeBar = F)
saveWidget(img, "images/barnafödande.html")
